{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"CloudHunting is an open source platform for methods and techniques mapped by MITRE ATT&CK\u00ae and leverged by Sigma rules that blue teamers can use to hunt after threats and misconfigurations (that can lead to threats) over their cloud environment. You are welcome to be a part of CloudHunting and contribute your cloud hunting knowledge by submitting a Pull Request.","title":"Summary"},{"location":"types_of_events_logs/","text":"","title":"Different Types of Cloud Logs\\Events"},{"location":"aws/initial-access/cloud-accounts/","tags":["Medium","T1078","T1078.004"],"text":"CloudTrail ConsoleLogin GetFederationToken GetSessionToken StartSession GetAuthorizationToken GuardDuty InitialAccess:IAMUser/AnomalousBehavior UnauthorizedAccess:IAMUser/ConsoleLoginSuccess.B","title":"Cloud Accounts"},{"location":"aws/initial-access/cloud-accounts/#cloudtrail","text":"ConsoleLogin GetFederationToken GetSessionToken StartSession GetAuthorizationToken","title":"CloudTrail"},{"location":"aws/initial-access/cloud-accounts/#guardduty","text":"InitialAccess:IAMUser/AnomalousBehavior UnauthorizedAccess:IAMUser/ConsoleLoginSuccess.B","title":"GuardDuty"},{"location":"aws/initial-access/default-accounts/","tags":["High","T1078","T1078.001"],"text":"Using of IAM User from External IP address 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 title : Using of IAM User from External IP address id : b3877a46-b2ff-4766-b36e-5ed311058cdd status : test description : Detects the using of IAM user from outside AWS range author : asafaprozper date : 2022/11/01 tags : - attack.initial_access - attack.t1078.001 logsource : product : aws service : cloudtrail detection : selection_source : userIdentity.type : IAMUser filter : sourceIPAddress : - '*.amazonaws.com' - 'AWS Internal' condition : selection_source and not filter falsepositives : - Sometimes DevOps using a strong IAM user (such as, \"jenkins\" or \"teamcity\") from their personal workstation for troubleshooting - Detecting access from other AWS accounts, to avoid that you will need to add all AWS IP address ranges to exclude level : high AWS Root Account Activity 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 title : Using of a Root account id : b3877a46-b2ff-4766-b36e-5ed311058cdd status : test description : Detects the sensitive usage of a Root account in a more timely manner (comparing to GuardDuty) author : asafaprozper date : 2022/11/01 tags : - attack.initial_access - attack.t1078.001 logsource : product : aws service : cloudtrail detection : selection_source : userIdentity.type : root condition : selection_source falsepositives : - Using of root account for invoice and payments request for AWS support level : high Anonymous Principle Successful Requests 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 title : Anonymous Principle Successful Requests id : c8d96265-dde3-43a9-a7d2-ea48bca8e62a status : test description : Detects successful requests by Anonymous Principle which can lead for public exposure author : asafaprozper date : 2022/11/01 tags : - attack.initial_access - attack.t1078.001 logsource : product : aws service : cloudtrail detection : selection_source : userIdentity.accountId : ANONYMOUS_PRINCIPAL errorCode : success filter : - userAgent : \"[Amazon CloudFront]\" - eventName : PreflightRequest condition : selection_source and not filter falsepositives : - Using of root account for invoice and payments request for AWS support level : high GuardDuty Policy:IAMUser/RootCredentialUsage","title":"Default Accounts"},{"location":"aws/initial-access/default-accounts/#using-of-iam-user-from-external-ip-address","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 title : Using of IAM User from External IP address id : b3877a46-b2ff-4766-b36e-5ed311058cdd status : test description : Detects the using of IAM user from outside AWS range author : asafaprozper date : 2022/11/01 tags : - attack.initial_access - attack.t1078.001 logsource : product : aws service : cloudtrail detection : selection_source : userIdentity.type : IAMUser filter : sourceIPAddress : - '*.amazonaws.com' - 'AWS Internal' condition : selection_source and not filter falsepositives : - Sometimes DevOps using a strong IAM user (such as, \"jenkins\" or \"teamcity\") from their personal workstation for troubleshooting - Detecting access from other AWS accounts, to avoid that you will need to add all AWS IP address ranges to exclude level : high","title":"Using of IAM User from External IP address"},{"location":"aws/initial-access/default-accounts/#aws-root-account-activity","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 title : Using of a Root account id : b3877a46-b2ff-4766-b36e-5ed311058cdd status : test description : Detects the sensitive usage of a Root account in a more timely manner (comparing to GuardDuty) author : asafaprozper date : 2022/11/01 tags : - attack.initial_access - attack.t1078.001 logsource : product : aws service : cloudtrail detection : selection_source : userIdentity.type : root condition : selection_source falsepositives : - Using of root account for invoice and payments request for AWS support level : high","title":"AWS Root Account Activity"},{"location":"aws/initial-access/default-accounts/#anonymous-principle-successful-requests","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 title : Anonymous Principle Successful Requests id : c8d96265-dde3-43a9-a7d2-ea48bca8e62a status : test description : Detects successful requests by Anonymous Principle which can lead for public exposure author : asafaprozper date : 2022/11/01 tags : - attack.initial_access - attack.t1078.001 logsource : product : aws service : cloudtrail detection : selection_source : userIdentity.accountId : ANONYMOUS_PRINCIPAL errorCode : success filter : - userAgent : \"[Amazon CloudFront]\" - eventName : PreflightRequest condition : selection_source and not filter falsepositives : - Using of root account for invoice and payments request for AWS support level : high","title":"Anonymous Principle Successful Requests"},{"location":"aws/initial-access/default-accounts/#guardduty","text":"Policy:IAMUser/RootCredentialUsage","title":"GuardDuty"},{"location":"aws/initial-access/exploit-public-facing-application/","tags":["Initial Access","Exploit Public-Facing Application","High","T1190"],"text":"Ingress rule allowing access from any IP address 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 title : Ingress rule allowing access from any IP address id : 53bea7a4-d25e-444c-b385-3fad4b21d5f5 status : test description : Detects the creation or modification of security group with a public exposure. author : asafaprozper date : 2022/10/31 tags : - attack.initial_access - attack.t1190 logsource : product : aws service : cloudtrail detection : selection_source : eventSource : ec2.amazonaws.com eventName : - AuthorizeSecurityGroupIngress - ModifySecurityGroupRules keywords : - '0.0.0.0/0' filter : sourceIPAddress : eks.amazonaws.com condition : selection_source and keywords and not filter falsepositives : - The security group created with 0.0.0.0, but the cloud resource is without external IP address\\protected with WAF\\behind LoadBalance so it not really publicly exposed. level : high Resource Exposed to All Users or All Auth Users 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 title : Resource Exposed to All Users or All Auth Users id : f26a54a1-6e8a-4be3-9adb-2d90acc0d5c8 status : test description : Detects a policy which granting access to all users (public) or all authenticated AWS users. author : asafaprozper date : 2022/10/31 tags : - attack.initial_access - attack.t1190 logsource : product : aws service : cloudtrail detection : selection_source : eventName : - FunctionURLAllowPublicAccess keywords : - 'http://acs.amazonaws.com/groups/global/AllUsers' - 'http://acs.amazonaws.com/groups/global/AuthenticatedUsers' - '\"Principal\":\"*\"' - '\"Principal\":{\"AWS\":\"*\"}' condition : selection_source or keywords falsepositives : - Sometimes send sns is publicy exposed to all users by default level : high Creation of application endpoint Creation of LB public","title":"Exploit Public-Facing Application"},{"location":"aws/initial-access/exploit-public-facing-application/#ingress-rule-allowing-access-from-any-ip-address","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 title : Ingress rule allowing access from any IP address id : 53bea7a4-d25e-444c-b385-3fad4b21d5f5 status : test description : Detects the creation or modification of security group with a public exposure. author : asafaprozper date : 2022/10/31 tags : - attack.initial_access - attack.t1190 logsource : product : aws service : cloudtrail detection : selection_source : eventSource : ec2.amazonaws.com eventName : - AuthorizeSecurityGroupIngress - ModifySecurityGroupRules keywords : - '0.0.0.0/0' filter : sourceIPAddress : eks.amazonaws.com condition : selection_source and keywords and not filter falsepositives : - The security group created with 0.0.0.0, but the cloud resource is without external IP address\\protected with WAF\\behind LoadBalance so it not really publicly exposed. level : high","title":"Ingress rule allowing access from any IP address"},{"location":"aws/initial-access/exploit-public-facing-application/#resource-exposed-to-all-users-or-all-auth-users","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 title : Resource Exposed to All Users or All Auth Users id : f26a54a1-6e8a-4be3-9adb-2d90acc0d5c8 status : test description : Detects a policy which granting access to all users (public) or all authenticated AWS users. author : asafaprozper date : 2022/10/31 tags : - attack.initial_access - attack.t1190 logsource : product : aws service : cloudtrail detection : selection_source : eventName : - FunctionURLAllowPublicAccess keywords : - 'http://acs.amazonaws.com/groups/global/AllUsers' - 'http://acs.amazonaws.com/groups/global/AuthenticatedUsers' - '\"Principal\":\"*\"' - '\"Principal\":{\"AWS\":\"*\"}' condition : selection_source or keywords falsepositives : - Sometimes send sns is publicy exposed to all users by default level : high","title":"Resource Exposed to All Users or All Auth Users"},{"location":"aws/initial-access/exploit-public-facing-application/#creation-of-application-endpoint","text":"","title":"Creation of application endpoint"},{"location":"aws/initial-access/exploit-public-facing-application/#creation-of-lb-public","text":"","title":"Creation of LB public"},{"location":"aws/initial-access/trusted-relationship/","text":"Nothing yet.","title":"Trusted Relationship"}]}