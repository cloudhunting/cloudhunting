{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#introduction","title":"Introduction","text":"<p>CloudHunting is an open-source community-driven website that provides methods and techniques for hunting threats and misconfigurations in cloud environments. Our mission is to provide a comprehensive and effective solution for organizations and cyber defenders to detect, respond and protect against the growing threat landscape in the cloud. Our framework leverages the power of Sigma Rules, a standardized format for writing signatures to identify suspicious activity and anomalies in log events, and maps them to the techniques outlined in the MITRE ATT&amp;CK cloud framework. This integration allows us to offer a unique and up-to-date coverage of common attack techniques, misconfigurations, and attack vectors that are specific to cloud environments.</p> <p>At CloudHunting, we believe that the best way to stay ahead of threats is to collaborate and share knowledge. That's why our framework is open-source and community-driven, allowing security professionals to contribute and share their expertise with the wider community. We are proud to make it available as an open-source project and welcome contributions from the community.</p> <p>Thanks for visiting, and happy hunting!</p>"},{"location":"#disclaimer","title":"Disclaimer","text":"<p>The information provided on this website is for general informational purposes only. CloudHunting makes no representations or warranties of any kind regarding the completeness, accuracy or suitability of the information provided. Use of this website is at your own risk.</p>"},{"location":"aws_logs_types/","title":"AWS","text":"<p>AWS provides several types of logs to help you monitor and troubleshoot your AWS resources, as well as enhance security. Below you can find a selection of the most commonly used AWS logs for security purposes.</p>"},{"location":"aws_logs_types/#cloudtrail-logs","title":"CloudTrail Logs","text":"<p>These logs provide a record of all AWS API calls made on your account, including information such as the identity of the caller, the time of the call, the request parameters, and the response elements. They can be used for security analysis, compliance auditing, and identifying unexpected changes in your AWS environment.</p>"},{"location":"aws_logs_types/#cloudwatch-logs","title":"CloudWatch Logs","text":"<p>These logs provide a way to monitor, store, and access your log files from Amazon Elastic Compute Cloud (EC2) instances, AWS CloudTrail, and other cloud resources. They can be used to troubleshoot issues, security analysis, and compliance auditing.</p>"},{"location":"aws_logs_types/#vpc-flow-logs","title":"VPC Flow Logs","text":"<p>These logs capture information about IP traffic going to and from your Amazon Virtual Private Cloud (VPC) network interfaces. They can be used to troubleshoot connectivity issues, identify potential security risks, and monitor network traffic patterns.</p>"},{"location":"aws_logs_types/#s3-access-logs","title":"S3 Access Logs","text":"<p>These logs provide detailed information about all access to your Amazon S3 bucket, including information such as the identity of the requester, the time of the request, the request parameters, and the response elements. They can be used for security analysis, compliance auditing, and identifying unexpected changes in your S3 bucket.</p>"},{"location":"aws_logs_types/#s3-data-events","title":"S3 Data Events","text":"<p>These logs provide detailed information about all data events in your Amazon S3 bucket, including information such as object creation, deletion, and access. They can be used for security analysis, compliance auditing, and identifying unexpected changes in your S3 bucket.</p>"},{"location":"aws_logs_types/#route-53-logs","title":"Route 53 Logs","text":"<p>These logs provide detailed information about all DNS queries made to your Amazon Route 53 domains. They include information such as the identity of the requester, the time of the request, the request parameters, and the response elements. They can be used for security analysis, compliance auditing, and identifying unexpected changes in your DNS service.</p>"},{"location":"aws_logs_types/#aws-config-logs","title":"AWS Config Logs","text":"<p>These logs provide a detailed record of the configuration of your AWS resources. They can be used for security analysis, compliance auditing, and identifying unexpected changes in your AWS environment.</p>"},{"location":"aws_logs_types/#aws-guardduty-logs","title":"AWS GuardDuty Logs","text":"<p>These logs provide a detailed record of security findings from AWS GuardDuty, which is a threat detection service that continuously monitors for malicious or unauthorized behavior in your AWS environment. It can be used for security analysis, identifying and respond to potential security threats.</p>"},{"location":"aws_logs_types/#aws-inspector-logs","title":"AWS Inspector Logs","text":"<p>These logs provide a detailed record of the assessment results from AWS Inspector, which is a security assessment service that helps you identify vulnerabilities and deviations from security best practices in your AWS environment. They can be used for security analysis, identifying and respond to potential security vulnerabilities.</p>"},{"location":"aws_logs_types/#aws-security-hub-logs","title":"AWS Security Hub Logs","text":"<p>These logs provide a detailed record of findings from AWS Security Hub, which is a security management service that aggregates security findings from multiple AWS services, such as Amazon GuardDuty, Amazon Inspector, and Amazon Macie, in one place. They can be used for security analysis, identifying and respond to potential security threats.</p>"},{"location":"blog_posts/","title":"Threat Hunting Resources","text":"<p>We believe that sharing knowledge and information within the cloud security community is crucial to helping organizations stay secure. If you have written a blog post or article that covers a topic related to cloud security, please don't hesitate to share it with us. We welcome new contributions and will be happy to reference your work on our website by simply create a Pull Request with a link to the article.</p> Publish date Cloud Author Link Sigma Rules Created December 28, 2022 AWS Andre Rall (uptycs) Detecting Anomalous AWS Sessions From Temporary Credentials December, 2022 GCP Google Incident response in  GCP Novemeber, 2019 AWS Shaun McCullough (SANS) Enabling a Threat Hunting Capability in AWS December 05, 2019 AWS Chris Farris SEC339 - Actionable threat hunting in AWS Jan 25, 2021 AWS George Fekkas Quick and Dirty CloudTrail Threat Hunting Log Analysis June 09, 2019 AWS Chris Farris Threat Hunting with CloudTrail and GuardDuty in Splunk None AWS Eliav Livneh, Hunters' Research Team Detecting Obfuscated Attacker IPs in AWS 2020-08-04 AWS Tim Orr Investigation of API activity using Athena and notification of actions using EventBridge"},{"location":"cloud_framework_categories/","title":"Cloud Framework Categories","text":"<p>The Cloud framework is divided into several categories, each representing a different stage of the attack life-cycle.</p> Technique Description Initial Access Techniques used to gain initial access to the cloud environment Execution Techniques used to run malware or scripts in the cloud environment Persistence Techniques used to maintain a presence in the cloud environment Privilege Escalation Techniques used to gain elevated permissions in the cloud environment Defense Evasion Techniques used to evade detection and response in the cloud environment Credential Access Techniques used to gain access to credentials and secrets in the cloud environment Lateral Movement Techniques used to move laterally within the cloud environment Collection Techniques used to collect data from the cloud environment Exfiltration Techniques used to exfiltrate data from the cloud environment Impact Techniques used to disrupt availability or compromise integrity by manipulating business and operational processes"},{"location":"cloud_mitre_attack/","title":"What is it the framework?","text":"<p>The MITRE ATT&amp;CK Cloud framework is an extension of the widely-used MITRE ATT&amp;CK framework, specifically tailored for cloud environments. It provides a comprehensive understanding of the tactics, techniques, and procedures used by cyber threats in cloud environments, enabling security professionals to more effectively identify and respond to potential threats. It includes new techniques and tactics that have emerged as a result of the widespread adoption of cloud services and infrastructure.</p>"},{"location":"gcp_logs_types/","title":"GCP","text":"<p>GCP provides several types of logs to help you monitor and troubleshoot your GCP resources, as well as enhance security. By leveraging these logs, you can have a comprehensive security visibility and monitoring to detect and respond to potential security threats.</p>"},{"location":"gcp_logs_types/#cloud-audit-logs","title":"Cloud Audit Logs","text":"<p>These logs provide a comprehensive record of all API calls made on your GCP account, including information such as the identity of the caller, the time of the call, the request parameters, and the response elements. They can be used to track user actions, detect and investigate security incidents, and ensure compliance with security policies.</p>"},{"location":"gcp_logs_types/#cloud-security-command-center-cscc-logs","title":"Cloud Security Command Center (CSCC) Logs","text":"<p>These logs provide security findings from CSCC, a security management service that helps you identify and respond to potential security threats in your GCP environment. It can be used to detect and investigate security incidents, track the status of security alerts, and identify trends in your security posture.</p>"},{"location":"gcp_logs_types/#cloud-identity-and-access-management-iam-logs","title":"Cloud Identity and Access Management (IAM) Logs","text":"<p>These logs provide a record of all IAM-related events, such as user sign-in and sign-out, as well as changes to roles and permissions. They can be used to track user actions, detect and investigate security incidents, and ensure compliance with security policies.</p>"},{"location":"gcp_logs_types/#cloud-data-loss-prevention-dlp-logs","title":"Cloud Data Loss Prevention (DLP) Logs","text":"<p>These logs provide information about DLP findings and actions, such as sensitive data detection, data masking, and de-identification. They can be used to detect and protect sensitive data, ensure compliance with regulatory requirements, and monitor data access.</p>"},{"location":"gcp_logs_types/#stackdriver-logging","title":"Stackdriver Logging","text":"<p>This is a powerful logging service that allows you to store, search, analyze, and alert on log data and events from GCP and other cloud resources. It can be used to monitor system and application logs, identify potential security risks, and troubleshoot security issues.</p>"},{"location":"gcp_logs_types/#stackdriver-trace","title":"Stackdriver Trace","text":"<p>This service allows you to collect and analyze latency data from your applications, to help you identify and resolve performance issues. It can also be used to monitor network traffic patterns and identify potential security risks.</p>"},{"location":"sigma_rules/","title":"What Are Sigma Rules?","text":"<p>Sigma rules are YAML-written textual signatures designed to identify suspicious activity over log events which making them useful for creating incident response detection or automated responses. One of the main advantages of these rules is their standardized format, which allows them to be written once and applied across various SIEM products without needing to rewrite the rule. However, Sigma rules still need to be written which can take time and effort to build the appropriate rule for a specific case and avoid false-positives.</p> <p>Using CloudHunting you will find a varity collection of pre-built Sigma rules that have been specifically designed to detect common cloud-based attack techniques, as well as misconfigurations that could leave organizations vulnerable to attack. The rules mapped by the MITRE ATT&amp;CK Cloud framework techniques with the intent to cover a wide range of scenarios, including common attack techniques, such as lateral movement and privilege escalation, as well as more specific misconfigurations and attack vectors that are unique to cloud environments.</p>"},{"location":"utilizing_igma_rules_for_cloudhunting/","title":"Mapping CloudHunting Sigma Rules by MITRE ATT&amp;CK Cloud Framework","text":"<p>The mapping of Sigma rules with the MITRE ATT&amp;CK cloud framework is a new and exclusive feature offered by \"CloudHunting.\" It allows organizations and cyber defenders to effectively hunt for threats and misconfigurations in their cloud environments by focus their attention on the areas that are most critical and susceptible to attacks. Additionally, it provides an efficient way to assess the organization current security posture and identify areas where they can improve. This, in turn, can help to prioritize security measures and improve the efficiency of their security operations, leading to increased protection against cyber threats and a more secure cloud environment.</p> <p>The combination of Sigma rules and the mapping to the MITRE ATT&amp;CK cloud framework makes \"CloudHunting\" a valuable tool for organizations looking to enhance their cloud security posture and stay ahead of the curve with up-to-date protection against the latest threats and misconfigurations in the cloud.</p>"},{"location":"rules_mapped_by_technique/execution/malicious-image/","title":"Malicious Image","text":"AWSGCP","tags":["Initial Access","Trusted Relationship","T1199"]},{"location":"rules_mapped_by_technique/initial-access/cloud-accounts/","title":"Cloud Accounts","text":"","tags":["Initial Access","T1078","T1078.004"]},{"location":"rules_mapped_by_technique/initial-access/cloud-accounts/#cloudtrail","title":"CloudTrail","text":"<pre><code>ConsoleLogin\nGetFederationToken\nGetSessionToken\nStartSession\nGetAuthorizationToken\n</code></pre>","tags":["Initial Access","T1078","T1078.004"]},{"location":"rules_mapped_by_technique/initial-access/cloud-accounts/#guarddutyscc-detections","title":"GuardDuty\\SCC Detections","text":"AWS GuardDutyGCP Security Command Center <pre><code>InitialAccess:IAMUser/AnomalousBehavior\nUnauthorizedAccess:IAMUser/ConsoleLoginSuccess.B\n</code></pre> <pre><code>\n</code></pre>","tags":["Initial Access","T1078","T1078.004"]},{"location":"rules_mapped_by_technique/initial-access/default-accounts/","title":"Default Accounts","text":"","tags":["Initial Access","T1078","T1078.001"]},{"location":"rules_mapped_by_technique/initial-access/default-accounts/#using-of-iam-user-from-external-ip-address","title":"Using of IAM User from External IP address","text":"AWSGCP <pre><code>title: Using of IAM User from External IP address\nid: b3877a46-b2ff-4766-b36e-5ed311058cdd\nstatus: test\ndescription: Detects the using of IAM user from outside AWS range\nauthor: asafaprozper\ndate: 2022/11/01\ntags:\n- attack.initial_access\n- attack.t1078.001\nlogsource:\nproduct: aws\nservice: cloudtrail\ndetection:\nselection_source:\nuserIdentity.type: IAMUser\nfilter:\nsourceIPAddress:\n- '*.amazonaws.com'\n- 'AWS Internal'\ncondition: selection_source and not filter\nfalsepositives:\n- Sometimes DevOps using a strong IAM user (such as, \"jenkins\" or \"teamcity\") from their personal workstation for troubleshooting\n- Detecting access from other AWS accounts, to avoid that you will need to add all AWS IP address ranges to exclude\nlevel: high\n</code></pre> <pre><code>\n</code></pre>","tags":["Initial Access","T1078","T1078.001"]},{"location":"rules_mapped_by_technique/initial-access/default-accounts/#aws-root-account-activity","title":"AWS Root Account Activity","text":"AWS <pre><code>title: Using of a Root account\nid: b3877a46-b2ff-4766-b36e-5ed311058cdd\nstatus: test\ndescription: Detects the sensitive usage of a Root account in a more timely manner (comparing to GuardDuty)\nauthor: asafaprozper\ndate: 2022/11/01\ntags:\n- attack.initial_access\n- attack.t1078.001\nlogsource:\nproduct: aws\nservice: cloudtrail\ndetection:\nselection_source:\nuserIdentity.type: root\ncondition: selection_source\nfalsepositives:\n- Using of root account for invoice and payments request for AWS support\n- Using of root account for disabling region-lock\nlevel: high\n</code></pre>","tags":["Initial Access","T1078","T1078.001"]},{"location":"rules_mapped_by_technique/initial-access/default-accounts/#anonymous-principle-successful-requests","title":"Anonymous Principle Successful Requests","text":"AWSGCP <pre><code>title: Anonymous Principle Successful Requests\nid: c8d96265-dde3-43a9-a7d2-ea48bca8e62a\nstatus: test\ndescription: Detects successful requests by Anonymous Principle which can indicate on public exposure\nauthor: asafaprozper\ndate: 2022/11/01\ntags:\n- attack.initial_access\n- attack.t1078.001\nlogsource:\nproduct: aws\nservice: cloudtrail\ndetection:\nselection_source:\nuserIdentity.accountId: ANONYMOUS_PRINCIPAL\nerrorCode: success\nfilter:\n- userAgent: \"[Amazon CloudFront]\"\n- eventName: PreflightRequest\ncondition: selection_source and not filter\nfalsepositives:\n- Public exposure that meant to be exposed to anyone on the internet without authentication\nlevel: high\n</code></pre> <pre><code>\n</code></pre>","tags":["Initial Access","T1078","T1078.001"]},{"location":"rules_mapped_by_technique/initial-access/default-accounts/#guarddutyscc-detections","title":"GuardDuty\\SCC Detections","text":"AWS GuardDutyGCP Security Command Center <pre><code>Policy:IAMUser/RootCredentialUsage\n</code></pre> <pre><code>\n</code></pre>","tags":["Initial Access","T1078","T1078.001"]},{"location":"rules_mapped_by_technique/initial-access/exploit-public-facing-application/","title":"Exploit Public-Facing Application","text":"","tags":["Initial Access","Exploit Public-Facing Application","High","T1190"]},{"location":"rules_mapped_by_technique/initial-access/exploit-public-facing-application/#security-groupfw-with-ingress-rule-allowing-access-from-any-ip-address","title":"Security Group\\FW with Ingress rule allowing access from any IP address","text":"AWSGCP <pre><code>title: Creation of AWS Security group ingress rule allowing access from any IP address\nid: 53bea7a4-d25e-444c-b385-3fad4b21d5f5\nstatus: test\ndescription: Detects the creation or modification of security group with a public exposure.\nauthor: asafaprozper\ndate: 2022/10/31\ntags:\n- attack.initial_access\n- attack.t1190\nlogsource:\nproduct: aws\nservice: cloudtrail\ndetection:\nselection_source:\neventSource: ec2.amazonaws.com\neventName: - AuthorizeSecurityGroupIngress\n- ModifySecurityGroupRules\nkeywords:\n- '0.0.0.0/0'\nfilter:\nsourceIPAddress: eks.amazonaws.com\ncondition: selection_source and keywords and not filter\nfalsepositives:\n- The security group created with 0.0.0.0, but the cloud resource is without external IP address or protected with WAF rules for specific IP ranges.\nlevel: high\n</code></pre> <pre><code>title: FW rule allowing access from any IP address over GCP\nid: a81899a4-b0f3-4f5f-a0f4-62f76962321a\nstatus: test\ndescription: Detects the creation or update of FW rule with a public exposure.\nauthor: asafaprozper\ndate: 2022/11/01\ntags:\n- attack.initial_access\n- attack.t1190\nlogsource:\nproduct: gcp\nservice: compute.googleapis.com\ndetection:\nselection_source:\ndata.resource.type: gce_firewall_rule\ndata.protoPayload.methodName: - v1.compute.firewalls.insert\n- v1.compute.firewalls.update\n- v1.compute.firewalls.patch\ndata.protoPayload.request.alloweds:\n- \"*\"\nkeywords:\n- '0.0.0.0/0'\ncondition: selection_source and keywords\nfalsepositives:\n- The security group created with 0.0.0.0, but the cloud resource is without external IP address or protected with WAF rules for specific IP ranges.\nlevel: high\n</code></pre>","tags":["Initial Access","Exploit Public-Facing Application","High","T1190"]},{"location":"rules_mapped_by_technique/initial-access/exploit-public-facing-application/#resource-exposed-to-all-users-or-all-auth-users","title":"Resource Exposed to All Users or All Auth Users","text":"AWSGCP <pre><code>title: Resource Exposed to All Users or All Auth Users\nid: f26a54a1-6e8a-4be3-9adb-2d90acc0d5c8\nstatus: test\ndescription: Detects a policy which granting access to all users (public) or all authenticated AWS users.\nauthor: asafaprozper\ndate: 2022/10/31\ntags:\n- attack.initial_access\n- attack.t1190\nlogsource:\nproduct: aws\nservice: cloudtrail\ndetection:\nselection_source:\neventName: - FunctionURLAllowPublicAccess\nkeywords:\n- 'http://acs.amazonaws.com/groups/global/AllUsers'\n- 'http://acs.amazonaws.com/groups/global/AuthenticatedUsers'\n- '\"Principal\":\"*\"'\n- '\"Principal\":{\"AWS\":\"*\"}'\ncondition: selection_source or keywords\nfalsepositives:\n- Sometimes send sns is publicy exposed to all users by default\nlevel: high\n</code></pre> <pre><code>title: Resource Exposed to All Users or All Auth Users\nid: 249c3646-30aa-45d1-b235-8d2c7f6240ea\nstatus: test\ndescription: Detects an IAM policy which granting access to all users (public) or all authenticated Google users.\nauthor: asafaprozper\ndate: 2022/11/01\ntags:\n- attack.initial_access\n- attack.t1190\nlogsource:\nproduct: gcp\nservice: \"*.googleapis.com\"\ndetection:\nselection_source:\ndata.protoPayload.methodName|contains:\n- \"SetIam\"\ndata.protoPayload.serviceData.policyData.bindingDeltas.member: - \"allUsers\"\n- \"allAuthenticatedUsers\"\ndata.protoPayload.serviceData.policyData.bindingDeltas.action:\n- \"ADD\"\ncondition: selection_source\nfalsepositives:\n- not found any\nlevel: high\n</code></pre>","tags":["Initial Access","Exploit Public-Facing Application","High","T1190"]},{"location":"rules_mapped_by_technique/initial-access/trusted-relationship/","title":"Trusted Relationship","text":"AWSGCP","tags":["Initial Access","Trusted Relationship","T1199"]}]}